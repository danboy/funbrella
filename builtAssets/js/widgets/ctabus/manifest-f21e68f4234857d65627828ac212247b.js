function ctabus(a){jade.debug=[{lineno:1,filename:undefined}];try{var b=[],c=a||{},d=c.stop,e=c.busses;return jade.debug.unshift({lineno:1,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:1,filename:jade.debug[0].filename}),b.push("<h1>"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:1,filename:jade.debug[0].filename}),b.push(""+jade.escape((jade.interp=d)==null?"":jade.interp)+""),jade.debug.shift(),jade.debug.shift(),b.push("</h1>"),jade.debug.shift(),jade.debug.unshift({lineno:3,filename:jade.debug[0].filename}),b.push("<table>"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:3,filename:jade.debug[0].filename}),function(){var a=e;if("number"==typeof a.length)for(var c=0,d=a.length;c<d;c++){var f=a[c];jade.debug.unshift({lineno:3,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:4,filename:jade.debug[0].filename}),b.push("<tr"+jade.attrs({"class":[""+(f.arriving||"")+""]},{"class":!0})+">"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:5,filename:jade.debug[0].filename}),b.push("<td>"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:5,filename:jade.debug[0].filename}),b.push(""+jade.escape((jade.interp=f.rtdir)==null?"":jade.interp)+" "+jade.escape((jade.interp=f.des)==null?"":jade.interp)+""),jade.debug.shift(),jade.debug.shift(),b.push("</td>"),jade.debug.shift(),jade.debug.unshift({lineno:6,filename:jade.debug[0].filename}),b.push("<td>"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:6,filename:jade.debug[0].filename}),b.push(""+jade.escape((jade.interp=f.arrival)==null?"":jade.interp)+""),jade.debug.shift(),jade.debug.shift(),b.push("</td>"),jade.debug.shift(),jade.debug.shift(),b.push("</tr>"),jade.debug.shift(),jade.debug.shift()}else{var d=0;for(var c in a){d++;var f=a[c];jade.debug.unshift({lineno:3,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:4,filename:jade.debug[0].filename}),b.push("<tr"+jade.attrs({"class":[""+(f.arriving||"")+""]},{"class":!0})+">"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:5,filename:jade.debug[0].filename}),b.push("<td>"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:5,filename:jade.debug[0].filename}),b.push(""+jade.escape((jade.interp=f.rtdir)==null?"":jade.interp)+" "+jade.escape((jade.interp=f.des)==null?"":jade.interp)+""),jade.debug.shift(),jade.debug.shift(),b.push("</td>"),jade.debug.shift(),jade.debug.unshift({lineno:6,filename:jade.debug[0].filename}),b.push("<td>"),jade.debug.unshift({lineno:undefined,filename:jade.debug[0].filename}),jade.debug.unshift({lineno:6,filename:jade.debug[0].filename}),b.push(""+jade.escape((jade.interp=f.arrival)==null?"":jade.interp)+""),jade.debug.shift(),jade.debug.shift(),b.push("</td>"),jade.debug.shift(),jade.debug.shift(),b.push("</tr>"),jade.debug.shift(),jade.debug.shift()}}}.call(this),jade.debug.shift(),jade.debug.shift(),b.push("</table>"),jade.debug.shift(),jade.debug.shift(),b.join("")}catch(f){jade.rethrow(f,jade.debug[0].filename,jade.debug[0].lineno)}}var Funbrella=Funbrella||{};Funbrella.ctabus=Funbrella.WidgetView.extend({setup:function(){this.url=this.getUrl(),console.log.log("setup done")},prefs:{urls:["http://www.ctabustracker.com/bustime/api/v1/getpredictions?key=ET5WjsrDL2XZ9eD9qLVRiWuRq&rt=66&stpid=606"],startUrl:0,strip:/ \(Brown Line\)/g,frequency:30},config:{xml:!0},template:ctabus,getUrl:function(){return this.url=this.prefs.startUrl<this.prefs.urls.length-1?this.prefs.startUrl+1:0,this.prefs.urls[this.prefs.startUrl]},data:function(a,b){this.url=this.getUrl();var c=this;if(a["bustime-response"]==0)var a={stop:"No upcoming busses."};else{var d=a["bustime-response"].prd;d[0]||(d=[d]);var a={busses:c.cleanDate(d),stop:d[0].stpnm.replace(c.prefs.strip,"")}}b(a)},cleanDate:function(a){return a=a.map(function(a){var b=this.getDate(a.prdtm);return a.arrival=b>0?b+" min":"now",a.arrival=="arriving"&&(a.arriving=!0),a}.bind(this)),a},getDate:function(a){var b=/^(\d{4})?(\d{2})?(\d{2})[T ]0?(\d+:\d+)$/,c=a.replace(b,"$2 $3 $1 $4"),d=new Date(c),e=new Date,f=Math.floor((d.getTime()-e.getTime())/6e4);return f}})(function(){}).call(this)